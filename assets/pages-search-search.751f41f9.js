import{o as l,c as e,w as a,b as s,e as t,f as o,g as u,m as c,a1 as n,R as i,a2 as r,x as d,y as f,F as v,a3 as _,I as m,a4 as g,t as h,k,H as p}from"./index-d83f280a.js";import{_ as y}from"./_plugin-vue_export-helper.1b428a4d.js";import{u as I}from"./music.aa7f92d9.js";const C=y({__name:"SearchDialog",props:["showDialog","detailItem"],emits:["closeDialog"],setup(c,{emit:n}){const i=n,r=l=>{l.stopPropagation()};return(n,d)=>{const f=u;return c.showDialog?(l(),e(f,{key:0,class:"dialogWrap",onClick:d[0]||(d[0]=l=>i("closeDialog"))},{default:a((()=>[s(f,{class:"dialog",onClick:r},{default:a((()=>[s(f,{class:"header"}),s(f,{class:"content"},{default:a((()=>[t(" 主题 ")])),_:1})])),_:1})])),_:1})):o("",!0)}}},[["__scopeId","data-v-a144010d"]]),w=y({__name:"search",setup(y){const w=c(""),S=c([]),D=c(!1),T=c(!1),x=c([]),b=c([]),j=c([]),N=c(0),P=c(!1),V=c({}),W=I();b.value=JSON.parse(localStorage.getItem("history"))||[];const A=()=>{w.value="",N.value=0,x.value=[]};n().then((l=>{console.log(l.result.hots),j.value=l.result.hots}));let E=null;const H=()=>{E&&clearTimeout(E),E=setTimeout((async()=>{const l=await _(w.value);console.log(l),S.value=l.result.songs}),10)},J=async(l=w.value,e=N.value)=>{w.value=l,D.value=!1;const a=await r(l,e);console.log(a.result),a.result.songs.forEach((l=>{x.value.push(l)})),setTimeout((()=>{T.value=!0}),20);-1===b.value.findIndex((e=>e===l))&&(b.value.push(l),localStorage.setItem("history",JSON.stringify(b.value)))},O=()=>{b.value=[],localStorage.removeItem("history")};i(w,(l=>{0===l.length&&(w.value="",N.value=0,x.value=[]),l.length>0?D.value=!0:D.value=!1,T.value=!1})),document.addEventListener("keypress",(l=>{13===l.keyCode&&J()}));const R=()=>{console.log("滚动到底部"),N.value+=30,J()};return(c,n)=>{const i=u,r=m,_=g;return l(),e(i,{class:"box"},{default:a((()=>[s(i,{class:"header"},{default:a((()=>[s(i,{class:"inp-wrap"},{default:a((()=>[s(i,{class:"search-icon"}),s(r,{class:"inp","auto-focus":"true",onInput:H,modelValue:w.value,"onUpdate:modelValue":n[0]||(n[0]=l=>w.value=l),type:"text",placeholder:"请输入搜索内容"},null,8,["modelValue"]),w.value.length>0?(l(),e(i,{key:0,class:"close-icon",onClick:A})):o("",!0)])),_:1}),s(i,{class:"search",onClick:n[1]||(n[1]=l=>J(w.value))},{default:a((()=>[t(" 搜索 ")])),_:1}),D.value?(l(),e(i,{key:0,class:"searchSuggest"},{default:a((()=>[(l(!0),d(v,null,f(S.value,((o,u)=>(l(),e(i,{onClick:l=>J(o.name),class:"suggestItem",key:u},{default:a((()=>[s(i,{class:"suggestIcon"}),s(i,{class:"suggestContent"},{default:a((()=>[t(h(o.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):o("",!0),T.value?(l(),e(_,{key:1,"scroll-y":"","show-scrollbar":"false",onScrolltolower:R,class:"searchResult"},{default:a((()=>[(l(!0),d(v,null,f(x.value,((u,c)=>(l(),e(i,{class:"resultItem",key:c},{default:a((()=>[s(i,{class:"resultContent"},{default:a((()=>[s(i,{class:"resultName"},{default:a((()=>[t(h(u.name),1)])),_:2},1024),s(i,{class:"resultArtist"},{default:a((()=>[s(i,{class:"subTitIcon"},{default:a((()=>[t(" 超清母带 ")])),_:1}),t(" "+h(u.artists[0].name)+" ",1),u.alias.length>0?(l(),e(i,{key:0,class:"alias"},{default:a((()=>[t("  -  "+h(u.alias[0]),1)])),_:2},1024)):o("",!0)])),_:2},1024)])),_:2},1024),s(i,{class:"resultTools"},{default:a((()=>[s(i,{class:"playIcon",onClick:l=>((l,e)=>{W.musicSearch(l,e),p({url:`/pages/musicPlay/musicPlay?id=${e}`})})(u,u.id)},null,8,["onClick"]),s(i,{class:"detailIcon",onClick:l=>(l=>{P.value=!0,V.value=l})(u)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):o("",!0)])),_:1}),s(i,{class:"contentWrap"},{default:a((()=>[b.value.length>0?(l(),e(i,{key:0,class:"historyTitle"},{default:a((()=>[s(i,{class:""},{default:a((()=>[t(" 搜索历史 ")])),_:1}),s(i,{class:"clearHistory",onClick:O})])),_:1})):o("",!0),s(i,{class:"history"},{default:a((()=>[(l(!0),d(v,null,f(b.value,((s,o)=>(l(),e(i,{class:"historyItem",onClick:l=>J(s),key:o},{default:a((()=>[t(h(s),1)])),_:2},1032,["onClick"])))),128))])),_:1}),s(i,{class:"likeTitle"},{default:a((()=>[s(i,{class:""},{default:a((()=>[t(" 猜你喜欢 ")])),_:1}),s(i,{class:"fresh"})])),_:1}),s(i,{class:"like"},{default:a((()=>[s(i,{class:"likeItem",onClick:n[2]||(n[2]=l=>J("起风了"))},{default:a((()=>[t(" 起风了 ")])),_:1}),s(i,{class:"likeItem",onClick:n[3]||(n[3]=l=>J("纪念"))},{default:a((()=>[t(" 纪念 ")])),_:1}),s(i,{class:"likeItem",onClick:n[4]||(n[4]=l=>J("青花瓷"))},{default:a((()=>[t(" 青花瓷 ")])),_:1})])),_:1}),s(i,{class:"top"},{default:a((()=>[s(i,{class:"hotTitle"},{default:a((()=>[t(" 热搜列表 ")])),_:1}),s(i,{class:"hotItemWrap"},{default:a((()=>[(l(!0),d(v,null,f(j.value,((u,c)=>(l(),e(i,{class:k({hotItem:1,itemActive:c<3}),onClick:l=>J(u.first),key:c},{default:a((()=>[s(i,{class:k({order:1,active:c<3})},{default:a((()=>[t(h(c+1),1)])),_:2},1032,["class"]),t(" "+h(u.first)+" ",1),c<3?(l(),e(i,{key:0,class:"hotIcon"},{default:a((()=>[t(" 爆 ")])),_:1})):o("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),s(C,{showDialog:P.value,onCloseDialog:n[5]||(n[5]=l=>(c.e,void(P.value=!1))),detailItem:V.value},null,8,["showDialog","detailItem"])])),_:1})}}},[["__scopeId","data-v-1c622eb5"]]);export{w as default};
