import{o as e,c as a,w as s,b as l,k as t,d as u,e as o,t as c,j as i,g as n,H as d,m,K as r,r as f,a as p,x as _,f as g,F as v,y as h,R as y,a5 as k,M as I,a6 as C,z as w,a7 as x,a8 as T,a9 as S,I as b,aa as D,A as P,S as L,N as W}from"./index-f31ac781.js";import{_ as $}from"./plugin-vueexport-helper.1b428a4d.js";import{_ as j,m as A}from"./musicBar.e8d99f51.js";import{u as N}from"./music.3beb0eea.js";const B=$({name:"uniPopupMessage",mixins:[{data:()=>({}),created(){this.popup=this.getParent()},methods:{getParent(e="uniPopup"){let a=this.$parent,s=a.$options.name;for(;s!==e;){if(a=a.$parent,!a)return!1;s=a.$options.name}return a}}}],props:{type:{type:String,default:"success"},message:{type:String,default:""},duration:{type:Number,default:3e3},maskShow:{type:Boolean,default:!1}},data:()=>({}),created(){this.popup.maskShow=this.maskShow,this.popup.messageChild=this},methods:{timerClose(){0!==this.duration&&(clearTimeout(this.timer),this.timer=setTimeout((()=>{this.popup.close()}),this.duration))}}},[["render",function(d,m,r,f,p,_){const g=i,v=n;return e(),a(v,{class:"uni-popup-message"},{default:s((()=>[l(v,{class:t(["uni-popup-message__box fixforpc-width","uni-popup__"+r.type])},{default:s((()=>[u(d.$slots,"default",{},(()=>[l(g,{class:t(["uni-popup-message-text","uni-popup__"+r.type+"-text"])},{default:s((()=>[o(c(r.message),1)])),_:1},8,["class"])]),!0)])),_:3},8,["class"])])),_:3})}],["__scopeId","data-v-ec73a802"]]),E=$({__name:"SearchDialog",props:["showDialog","detailItem"],emits:["closeDialog"],setup(t,{emit:u}){const i=t,x=u,T=N(),S=d(),b=m(S.profile),D=m([]),P=m(0),L=m(null),W=m(null),$=m(null),A=m(null);b.value||(b.value=S.setProfileData());const E=async()=>{const e=await y(b.value.userId);D.value=e.playlist};E(),r((()=>i),(()=>{(async()=>{const e=await k("music",i.detailItem.id);P.value=e.total})()}),{deep:!0});const H=()=>{T.musicBehind(i.detailItem,i.detailItem.id),L.value.open(),x("closeDialog")},U=()=>{b.value.userId?($.value.open(),x("closeDialog")):(W.value.open(),setTimeout((()=>{I({url:"/pages/login/login"})}),1e3))},V=()=>{I({url:`/pages/comment/comment?id=${i.detailItem.id}`})},F=e=>{e.stopPropagation()};return(u,d)=>{const m=w,r=n,y=f(p("uni-popup-message"),B),k=f(p("uni-popup"),j);return e(),_(v,null,[t.showDialog?(e(),a(r,{key:0,class:"dialogWrap",onClick:d[0]||(d[0]=e=>x("closeDialog"))},{default:s((()=>[l(r,{class:"dialog",onClick:F},{default:s((()=>[l(r,{class:"header"},{default:s((()=>[l(m,{class:"img",src:i.detailItem.artists[0].img1v1Url,mode:""},null,8,["src"]),l(r,{class:"info"},{default:s((()=>[l(r,{class:"name"},{default:s((()=>[o(c(i.detailItem.name),1)])),_:1}),l(r,{class:"artist"},{default:s((()=>[o(c(i.detailItem.artists[0].name),1)])),_:1})])),_:1})])),_:1}),l(r,{class:"content"},{default:s((()=>[l(r,{class:"item",onClick:H},{default:s((()=>[l(r,{class:"itemIcon nextPaly"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 下一首播放 ")])),_:1})])),_:1}),l(r,{class:"item",onClick:U},{default:s((()=>[l(r,{class:"itemIcon like"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 收藏到歌单 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon download"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 下载 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon recommend"}),l(r,{class:"itemContent",onClick:V},{default:s((()=>[o(" 评论("+c(P.value)+") ",1)])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon share"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 分享 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon singer"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 歌手:  "+c(i.detailItem.artists[0].name),1)])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon albums"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 专辑:  "+c(i.detailItem.album.name),1)])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon cloud"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 云推歌 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon buy"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 单曲购买 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon card"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 音乐礼品卡 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon music"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 更多乐谱 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon ding"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 设为铃声 ")])),_:1})])),_:1}),l(r,{class:"item"},{default:s((()=>[l(r,{class:"itemIcon close"}),l(r,{class:"itemContent"},{default:s((()=>[o(" 屏蔽歌手或歌曲 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):g("",!0),l(k,{class:"mesWrap",ref_key:"popup",ref:L,type:"message"},{default:s((()=>[l(y,{class:"mes",type:"success",message:"添加列表成功",duration:800})])),_:1},512),l(k,{class:"mesWrap",ref_key:"popup2",ref:W,type:"message"},{default:s((()=>[l(y,{class:"mes",type:"error",message:"请登录",duration:800})])),_:1},512),l(k,{class:"mesWrap",ref_key:"popup4",ref:A,type:"message"},{default:s((()=>[l(y,{class:"mes",type:"error",message:"歌曲已存在",duration:800})])),_:1},512),l(r,null,{default:s((()=>[l(k,{ref_key:"popup3",ref:$,type:"bottom","border-radius":"10px 10px 0 0","background-color":"#fff"},{default:s((()=>[l(r,{class:"playList"},{default:s((()=>[l(r,{class:"playListHeader"},{default:s((()=>[l(r,{class:"playListTitle"},{default:s((()=>[o(" 收藏到歌单 ")])),_:1}),l(r,{class:"selectAll"},{default:s((()=>[o(" 多选 ")])),_:1})])),_:1}),l(r,{class:"playListContent"},{default:s((()=>[l(r,{class:"playListItem"},{default:s((()=>[l(r,{class:"img new"},{default:s((()=>[o(" + ")])),_:1}),l(r,{class:"itemContent"},{default:s((()=>[l(r,{class:"contentTitle"},{default:s((()=>[o(" 新建歌单 ")])),_:1})])),_:1})])),_:1}),(e(!0),_(v,null,h(D.value,(t=>(e(),a(r,{onClick:e=>(async e=>{502===(await C("add",e.id,i.detailItem.id)).body.code&&A.value.open(),E()})(t),class:"playListItem"},{default:s((()=>[l(r,{class:"img"},{default:s((()=>[l(m,{src:t.coverImgUrl,mode:"widthFix"},null,8,["src"])])),_:2},1024),l(r,{class:"itemContent"},{default:s((()=>[l(r,{class:"contentTitle"},{default:s((()=>[o(c(t.name),1)])),_:2},1024),l(r,{class:"count"},{default:s((()=>[o(c(t.trackCount)+"首 ",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),256))])),_:1})])),_:1})])),_:1},512)])),_:1})],64)}}},[["__scopeId","data-v-363a4ce8"]]),H=$({__name:"search",setup(u){const i=m(""),d=m([]),f=m(!1),p=m(!1),y=m([]),k=m([]),I=m([]),C=m(0),w=m(!1),$=m({}),j=N();k.value=JSON.parse(localStorage.getItem("history"))||[];const B=()=>{i.value="",C.value=0,y.value=[]};x().then((e=>{console.log(e.result.hots),I.value=e.result.hots}));let H=null;const U=()=>{H&&clearTimeout(H),H=setTimeout((async()=>{const e=await S(i.value);console.log(e),d.value=e.result.songs,d.value.forEach((e=>{e.name=e.name.slice(i.value.length)}))}),10)},V=async(e=i.value,a=C.value)=>{i.value=e,f.value=!1;(await T(e,a)).result.songs.forEach((e=>{y.value.push(e)})),console.log(y.value),setTimeout((()=>{p.value=!0}),20);-1===k.value.findIndex((a=>a===e))&&(k.value.push(e),localStorage.setItem("history",JSON.stringify(k.value)))},F=()=>{k.value=[],localStorage.removeItem("history")};r(i,(e=>{0===e.length&&(i.value="",C.value=0,y.value=[]),e.length>0?f.value=!0:f.value=!1,p.value=!1})),document.addEventListener("keypress",(e=>{13===e.keyCode&&V()}));const J=()=>{console.log("滚动到底部"),C.value+=30,V()};return(u,m)=>{const r=n,C=b,x=D,T=P,S=L;return e(),a(r,{class:"box"},{default:s((()=>[l(A),l(r,{class:"header"},{default:s((()=>[l(r,{class:"inp-wrap"},{default:s((()=>[l(r,{class:"search-icon"}),l(C,{class:"inp","auto-focus":"true",onInput:U,modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=e=>i.value=e),type:"text",placeholder:"请输入搜索内容"},null,8,["modelValue"]),i.value.length>0?(e(),a(r,{key:0,class:"close-icon",onClick:B})):g("",!0)])),_:1}),l(r,{class:"search",onClick:m[1]||(m[1]=e=>V(i.value))},{default:s((()=>[o(" 搜索 ")])),_:1}),f.value?(e(),a(r,{key:0,class:"searchSuggest"},{default:s((()=>[(e(!0),_(v,null,h(d.value,((t,u)=>(e(),a(r,{onClick:e=>V(t.name),class:"suggestItem",key:u},{default:s((()=>[l(r,{class:"suggestIcon"}),l(r,{class:"suggestContent"},{default:s((()=>[l(r,{class:"itemTitle"},{default:s((()=>[o(c(i.value),1)])),_:1}),o(" "+c(t.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):g("",!0),p.value?(e(),a(x,{key:1,"scroll-y":"","show-scrollbar":"false",onScrolltolower:J,class:"searchResult"},{default:s((()=>[(e(!0),_(v,null,h(y.value,((t,u)=>(e(),a(r,{class:"resultItem",key:u},{default:s((()=>[l(r,{class:"resultContent"},{default:s((()=>[l(r,{class:"resultName"},{default:s((()=>[o(c(t.name),1)])),_:2},1024),l(r,{class:"resultArtist"},{default:s((()=>[l(r,{class:"subTitIcon"},{default:s((()=>[o(" 超清母带 ")])),_:1}),o(" "+c(t.artists[0].name)+" ",1),t.alias.length>0?(e(),a(r,{key:0,class:"alias"},{default:s((()=>[o("  -  "+c(t.alias[0]),1)])),_:2},1024)):g("",!0)])),_:2},1024)])),_:2},1024),l(r,{class:"resultTools"},{default:s((()=>[l(r,{class:"playIcon",onClick:e=>((e,a)=>{j.musicSearch(e,a),W({url:`/pages/musicPlay/musicPlay?id=${a}`})})(t,t.id)},null,8,["onClick"]),l(r,{class:"detailIcon",onClick:e=>(e=>{w.value=!0,$.value=e})(t)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):g("",!0)])),_:1}),l(r,{class:"contentWrap"},{default:s((()=>[k.value.length>0?(e(),a(r,{key:0,class:"historyTitle"},{default:s((()=>[l(r,{class:""},{default:s((()=>[o(" 搜索历史 ")])),_:1}),l(r,{class:"clearHistory",onClick:F})])),_:1})):g("",!0),l(r,{class:"history"},{default:s((()=>[(e(!0),_(v,null,h(k.value,((l,t)=>(e(),a(r,{class:"historyItem",onClick:e=>V(l),key:t},{default:s((()=>[o(c(l),1)])),_:2},1032,["onClick"])))),128))])),_:1}),l(r,{class:"likeTitle"},{default:s((()=>[l(r,{class:""},{default:s((()=>[o(" 猜你喜欢 ")])),_:1}),l(r,{class:"fresh"})])),_:1}),l(r,{class:"like"},{default:s((()=>[l(r,{class:"likeItem",onClick:m[2]||(m[2]=e=>V("起风了"))},{default:s((()=>[o(" 起风了 ")])),_:1}),l(r,{class:"likeItem",onClick:m[3]||(m[3]=e=>V("纪念"))},{default:s((()=>[o(" 纪念 ")])),_:1}),l(r,{class:"likeItem",onClick:m[4]||(m[4]=e=>V("青花瓷"))},{default:s((()=>[o(" 青花瓷 ")])),_:1})])),_:1}),l(S,{class:"swiper-wrap","indicator-dots":!1,autoplay:!0,interval:3e3,duration:1e3},{default:s((()=>[l(T,null,{default:s((()=>[l(r,{class:"swiper-item"},{default:s((()=>[l(r,{class:"top"},{default:s((()=>[l(r,{class:"hotTitle"},{default:s((()=>[o(" 热搜列表 ")])),_:1}),l(r,{class:"hotItemWrap"},{default:s((()=>[(e(!0),_(v,null,h(I.value,((u,i)=>(e(),a(r,{class:t({hotItem:1,itemActive:i<3}),onClick:e=>V(u.first),key:i},{default:s((()=>[l(r,{class:t({order:1,active:i<3})},{default:s((()=>[o(c(i+1),1)])),_:2},1032,["class"]),o(" "+c(u.first)+" ",1),i<3?(e(),a(r,{key:0,class:"hotIcon"},{default:s((()=>[o(" 爆 ")])),_:1})):g("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),l(T,null,{default:s((()=>[l(r,{class:"swiper-item"},{default:s((()=>[l(r,{class:"top"},{default:s((()=>[l(r,{class:"hotTitle"},{default:s((()=>[o(" 热搜列表 ")])),_:1}),l(r,{class:"hotItemWrap"},{default:s((()=>[(e(!0),_(v,null,h(I.value,((u,i)=>(e(),a(r,{class:t({hotItem:1,itemActive:i<3}),onClick:e=>V(u.first),key:i},{default:s((()=>[l(r,{class:t({order:1,active:i<3})},{default:s((()=>[o(c(i+1),1)])),_:2},1032,["class"]),o(" "+c(u.first)+" ",1),i<3?(e(),a(r,{key:0,class:"hotIcon"},{default:s((()=>[o(" 爆 ")])),_:1})):g("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),l(E,{showDialog:w.value,onCloseDialog:m[5]||(m[5]=e=>(u.e,void(w.value=!1))),detailItem:$.value},null,8,["showDialog","detailItem"])])),_:1})}}},[["__scopeId","data-v-989e1426"]]);export{H as default};
