import{o as e,c as l,w as a,b as s,e as t,t as c,f as o,z as u,g as n,m as i,a1 as d,R as m,a2 as r,x as f,y as _,F as v,a3 as g,I,a4 as h,k,J as C}from"./index-741e9bb4.js";import{_ as p}from"./_plugin-vue_export-helper.1b428a4d.js";import{u as y}from"./music.75902ecc.js";const w=p({__name:"SearchDialog",props:["showDialog","detailItem"],emits:["closeDialog"],setup(i,{emit:d}){const m=i,r=d,f=e=>{console.log(m.detailItem),e.stopPropagation()};return(d,_)=>{const v=u,g=n;return i.showDialog?(e(),l(g,{key:0,class:"dialogWrap",onClick:_[0]||(_[0]=e=>r("closeDialog"))},{default:a((()=>[s(g,{class:"dialog",onClick:f},{default:a((()=>[s(g,{class:"header"},{default:a((()=>[s(v,{class:"img",src:m.detailItem.artists[0].img1v1Url,mode:""},null,8,["src"]),s(g,{class:"info"},{default:a((()=>[s(g,{class:"name"},{default:a((()=>[t(c(m.detailItem.name),1)])),_:1}),s(g,{class:"artist"},{default:a((()=>[t(c(m.detailItem.artists[0].name),1)])),_:1})])),_:1})])),_:1}),s(g,{class:"content"},{default:a((()=>[s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon nextPaly"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 下一首播放 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon like"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 收藏到歌单 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon download"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 下载 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon recommend"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 评论 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon share"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 分享 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon singer"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 歌手:  "+c(m.detailItem.artists[0].name),1)])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon albums"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 专辑:  "+c(m.detailItem.album.name),1)])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon cloud"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 云推歌 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon buy"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 单曲购买 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon card"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 音乐礼品卡 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon music"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 更多乐谱 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon ding"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 设为铃声 ")])),_:1})])),_:1}),s(g,{class:"item"},{default:a((()=>[s(g,{class:"itemIcon close"}),s(g,{class:"itemContent"},{default:a((()=>[t(" 屏蔽歌手或歌曲 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):o("",!0)}}},[["__scopeId","data-v-5880bf5c"]]),S=p({__name:"search",setup(u){const p=i(""),S=i([]),b=i(!1),x=i(!1),D=i([]),T=i([]),P=i([]),j=i(0),J=i(!1),N=i({}),V=y();T.value=JSON.parse(localStorage.getItem("history"))||[];const W=()=>{p.value="",j.value=0,D.value=[]};d().then((e=>{console.log(e.result.hots),P.value=e.result.hots}));let A=null;const E=()=>{A&&clearTimeout(A),A=setTimeout((async()=>{const e=await g(p.value);console.log(e),S.value=e.result.songs}),10)},O=async(e=p.value,l=j.value)=>{p.value=e,b.value=!1;const a=await r(e,l);console.log(a.result),a.result.songs.forEach((e=>{D.value.push(e)})),setTimeout((()=>{x.value=!0}),20);-1===T.value.findIndex((l=>l===e))&&(T.value.push(e),localStorage.setItem("history",JSON.stringify(T.value)))},R=()=>{T.value=[],localStorage.removeItem("history")};m(p,(e=>{0===e.length&&(p.value="",j.value=0,D.value=[]),e.length>0?b.value=!0:b.value=!1,x.value=!1})),document.addEventListener("keypress",(e=>{13===e.keyCode&&O()}));const U=()=>{console.log("滚动到底部"),j.value+=30,O()};return(u,i)=>{const d=n,m=I,r=h;return e(),l(d,{class:"box"},{default:a((()=>[s(d,{class:"header"},{default:a((()=>[s(d,{class:"inp-wrap"},{default:a((()=>[s(d,{class:"search-icon"}),s(m,{class:"inp","auto-focus":"true",onInput:E,modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=e=>p.value=e),type:"text",placeholder:"请输入搜索内容"},null,8,["modelValue"]),p.value.length>0?(e(),l(d,{key:0,class:"close-icon",onClick:W})):o("",!0)])),_:1}),s(d,{class:"search",onClick:i[1]||(i[1]=e=>O(p.value))},{default:a((()=>[t(" 搜索 ")])),_:1}),b.value?(e(),l(d,{key:0,class:"searchSuggest"},{default:a((()=>[(e(!0),f(v,null,_(S.value,((o,u)=>(e(),l(d,{onClick:e=>O(o.name),class:"suggestItem",key:u},{default:a((()=>[s(d,{class:"suggestIcon"}),s(d,{class:"suggestContent"},{default:a((()=>[t(c(o.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):o("",!0),x.value?(e(),l(r,{key:1,"scroll-y":"","show-scrollbar":"false",onScrolltolower:U,class:"searchResult"},{default:a((()=>[(e(!0),f(v,null,_(D.value,((u,n)=>(e(),l(d,{class:"resultItem",key:n},{default:a((()=>[s(d,{class:"resultContent"},{default:a((()=>[s(d,{class:"resultName"},{default:a((()=>[t(c(u.name),1)])),_:2},1024),s(d,{class:"resultArtist"},{default:a((()=>[s(d,{class:"subTitIcon"},{default:a((()=>[t(" 超清母带 ")])),_:1}),t(" "+c(u.artists[0].name)+" ",1),u.alias.length>0?(e(),l(d,{key:0,class:"alias"},{default:a((()=>[t("  -  "+c(u.alias[0]),1)])),_:2},1024)):o("",!0)])),_:2},1024)])),_:2},1024),s(d,{class:"resultTools"},{default:a((()=>[s(d,{class:"playIcon",onClick:e=>((e,l)=>{V.musicSearch(e,l),C({url:`/pages/musicPlay/musicPlay?id=${l}`})})(u,u.id)},null,8,["onClick"]),s(d,{class:"detailIcon",onClick:e=>(e=>{J.value=!0,N.value=e})(u)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):o("",!0)])),_:1}),s(d,{class:"contentWrap"},{default:a((()=>[T.value.length>0?(e(),l(d,{key:0,class:"historyTitle"},{default:a((()=>[s(d,{class:""},{default:a((()=>[t(" 搜索历史 ")])),_:1}),s(d,{class:"clearHistory",onClick:R})])),_:1})):o("",!0),s(d,{class:"history"},{default:a((()=>[(e(!0),f(v,null,_(T.value,((s,o)=>(e(),l(d,{class:"historyItem",onClick:e=>O(s),key:o},{default:a((()=>[t(c(s),1)])),_:2},1032,["onClick"])))),128))])),_:1}),s(d,{class:"likeTitle"},{default:a((()=>[s(d,{class:""},{default:a((()=>[t(" 猜你喜欢 ")])),_:1}),s(d,{class:"fresh"})])),_:1}),s(d,{class:"like"},{default:a((()=>[s(d,{class:"likeItem",onClick:i[2]||(i[2]=e=>O("起风了"))},{default:a((()=>[t(" 起风了 ")])),_:1}),s(d,{class:"likeItem",onClick:i[3]||(i[3]=e=>O("纪念"))},{default:a((()=>[t(" 纪念 ")])),_:1}),s(d,{class:"likeItem",onClick:i[4]||(i[4]=e=>O("青花瓷"))},{default:a((()=>[t(" 青花瓷 ")])),_:1})])),_:1}),s(d,{class:"top"},{default:a((()=>[s(d,{class:"hotTitle"},{default:a((()=>[t(" 热搜列表 ")])),_:1}),s(d,{class:"hotItemWrap"},{default:a((()=>[(e(!0),f(v,null,_(P.value,((u,n)=>(e(),l(d,{class:k({hotItem:1,itemActive:n<3}),onClick:e=>O(u.first),key:n},{default:a((()=>[s(d,{class:k({order:1,active:n<3})},{default:a((()=>[t(c(n+1),1)])),_:2},1032,["class"]),t(" "+c(u.first)+" ",1),n<3?(e(),l(d,{key:0,class:"hotIcon"},{default:a((()=>[t(" 爆 ")])),_:1})):o("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),s(w,{showDialog:J.value,onCloseDialog:i[5]||(i[5]=e=>(u.e,void(J.value=!1))),detailItem:N.value},null,8,["showDialog","detailItem"])])),_:1})}}},[["__scopeId","data-v-45d8c148"]]);export{S as default};
