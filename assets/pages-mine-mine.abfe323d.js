import{M as t,N as e,O as a,P as s,o as i,c as l,w as r,b as n,k as o,x as c,F as d,y as u,n as h,d as g,e as p,t as f,f as m,Q as _,g as v,z as b,j as k,l as y,H as x,m as T,J as C,R as S,K as L,r as w,v as F,T as $,U as j,a as B}from"./index-774346cf.js";import{_ as I}from"./uni-icons.011c7786.js";import{W as U}from"./uni-cloud.es.feccdcf6.js";import{_ as A}from"./plugin-vueexport-helper.1b428a4d.js";import{m as W}from"./musicBar.dbde9100.js";import{S as P}from"./Sidebar.4c4d88ae.js";import{T as D}from"./TabToggle.fd19e24c.js";import{n as R}from"./index.6605ab17.js";import"./music.637fe340.js";const z=A({name:"UniListChat",emits:["click"],props:{title:{type:String,default:""},note:{type:String,default:""},clickable:{type:Boolean,default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},badgeText:{type:[String,Number],default:""},badgePositon:{type:String,default:"right"},time:{type:String,default:""},avatarCircle:{type:Boolean,default:!1},avatar:{type:String,default:""},avatarList:{type:Array,default:()=>[]}},computed:{isDraft(){return"[uni-im-draft]"==this.note.slice(0,14)},isSingle(){if("dot"===this.badgeText)return"uni-badge--dot";return this.badgeText.toString().length>1?"uni-badge--complex":"uni-badge--single"},computedAvatar(){return this.avatarList.length>4?(this.imageWidth=13.95,"avatarItem--3"):this.avatarList.length>1?(this.imageWidth=21.15,"avatarItem--2"):(this.imageWidth=45,"avatarItem--1")}},watch:{avatar:{handler(t){"cloud://"==t.substr(0,8)?U.getTempFileURL({fileList:[t]}).then((t=>{let e=t.fileList||t.result.fileList;this.avatarUrl=e[0].tempFileURL})):this.avatarUrl=t},immediate:!0}},data:()=>({isFirstChild:!1,border:!0,imageWidth:50,avatarUrl:""}),mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0),this.border=this.list.border)},methods:{getForm(t="uniList"){let e=this.$parent,a=e.$options.name;for(;a!==t;){if(e=e.$parent,!e)return!1;a=e.$options.name}return e},onClick(){""===this.to?(this.clickable||this.link)&&this.$emit("click",{data:{}}):this.openPage()},openPage(){-1!==["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(i){let l={url:this.to,success:t=>{this.$emit("click",{data:t})},fail:t=>{this.$emit("click",{data:t})}};switch(i){case"navigateTo":default:t(l);break;case"redirectTo":s(l);break;case"reLaunch":a(l);break;case"switchTab":e(l)}}}},[["render",function(t,e,a,s,y,x){const T=v,C=b,S=k;return i(),l(T,{"hover-class":a.clickable||a.link?"uni-list-chat--hover":"",class:"uni-list-chat",onClick:_(x.onClick,["stop"])},{default:r((()=>[n(T,{class:o({"uni-list--border":y.border,"uni-list-chat--first":y.isFirstChild})},null,8,["class"]),n(T,{class:"uni-list-chat__container"},{default:r((()=>[n(T,{class:"uni-list-chat__header-warp"},{default:r((()=>[a.avatarCircle||0===a.avatarList.length?(i(),l(T,{key:0,class:o(["uni-list-chat__header",{"header--circle":a.avatarCircle}])},{default:r((()=>[n(C,{class:o(["uni-list-chat__header-image",{"header--circle":a.avatarCircle}]),src:y.avatarUrl,mode:"aspectFill"},null,8,["class","src"])])),_:1},8,["class"])):(i(),l(T,{key:1,class:"uni-list-chat__header"},{default:r((()=>[(i(!0),c(d,null,u(a.avatarList,((t,e)=>(i(),l(T,{key:e,class:o(["uni-list-chat__header-box",x.computedAvatar]),style:h({width:y.imageWidth+"px",height:y.imageWidth+"px"})},{default:r((()=>[n(C,{class:"uni-list-chat__header-image",style:h({width:y.imageWidth+"px",height:y.imageWidth+"px"}),src:t.url,mode:"aspectFill"},null,8,["style","src"])])),_:2},1032,["class","style"])))),128))])),_:1}))])),_:1}),n(T,{class:"slot-header"},{default:r((()=>[g(t.$slots,"header",{},void 0,!0)])),_:3}),a.badgeText&&"left"===a.badgePositon?(i(),l(T,{key:0,class:o(["uni-list-chat__badge uni-list-chat__badge-pos",[x.isSingle]])},{default:r((()=>[n(S,{class:"uni-list-chat__badge-text"},{default:r((()=>[p(f("dot"===a.badgeText?"":a.badgeText),1)])),_:1})])),_:1},8,["class"])):m("",!0),n(T,{class:"uni-list-chat__content"},{default:r((()=>[n(T,{class:"uni-list-chat__content-main"},{default:r((()=>[n(S,{class:"uni-list-chat__content-title uni-ellipsis"},{default:r((()=>[p(f(a.title),1)])),_:1}),n(T,{style:{"flex-direction":"row"}},{default:r((()=>[x.isDraft?(i(),l(S,{key:0,class:"draft"},{default:r((()=>[p("[草稿]")])),_:1})):m("",!0),n(S,{class:"uni-list-chat__content-note uni-ellipsis"},{default:r((()=>[p(f(x.isDraft?a.note.slice(14):a.note),1)])),_:1})])),_:1})])),_:1}),n(T,{class:"uni-list-chat__content-extra"},{default:r((()=>[g(t.$slots,"default",{},(()=>[n(S,{class:"uni-list-chat__content-extra-text"},{default:r((()=>[p(f(a.time),1)])),_:1}),a.badgeText&&"right"===a.badgePositon?(i(),l(T,{key:0,class:o(["uni-list-chat__badge",[x.isSingle,"right"===a.badgePositon?"uni-list-chat--right":""]])},{default:r((()=>[n(S,{class:"uni-list-chat__badge-text"},{default:r((()=>[p(f("dot"===a.badgeText?"":a.badgeText),1)])),_:1})])),_:1},8,["class"])):m("",!0)]),!0)])),_:3})])),_:3})])),_:3})])),_:3},8,["hover-class","onClick"])}],["__scopeId","data-v-5d9ad8b2"]]);const E=A({name:"uniList","mp-weixin":{options:{multipleSlots:!1}},props:{stackFromEnd:{type:Boolean,default:!1},enableBackToTop:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},border:{type:Boolean,default:!0},renderReverse:{type:Boolean,default:!1}},created(){this.firstChildAppend=!1},methods:{loadMore(t){this.$emit("scrolltolower")},scroll(t){this.$emit("scroll",t)}}},[["render",function(t,e,a,s,n,o){const c=v;return i(),l(c,{class:"uni-list uni-border-top-bottom"},{default:r((()=>[a.border?(i(),l(c,{key:0,class:"uni-list--border-top"})):m("",!0),g(t.$slots,"default",{},void 0,!0),a.border?(i(),l(c,{key:1,class:"uni-list--border-bottom"})):m("",!0)])),_:3})}],["__scopeId","data-v-1f7cd97b"]]),M=A({__name:"mine",setup(t){const e=y("curCookie"),a=x(),s=T(a.profile),o=T(!1),h=T(null),g=T(0),_=T([]);C((()=>{var t;o.value=!!e,s.value?S(null==(t=s.value)?void 0:t.userId).then((t=>{_.value=t.playlist})):s.value=a.setProfileData()})),L(s,(()=>{var t;S(null==(t=s.value)?void 0:t.userId).then((t=>{_.value=t.playlist}))}));const k=T([{isSelect:!0,name:"音乐"},{isSelect:!1,name:"播客"},{isSelect:!1,name:"动态"}]),U=t=>{g.value=t};return(t,e)=>{const a=w(B("uni-icons"),I),y=v,x=b,T=w(B("uni-list-chat"),z),C=w(B("uni-list"),E),S=w(B("musicBar"),W);return i(),c(d,null,[n(y,{class:"content",style:{height:"100%"}},{default:r((()=>[n(y,{class:"header"},{default:r((()=>[n(a,{class:"bars",type:"bars",size:"24",onClick:e[0]||(e[0]=()=>{h.value.showDrawer()})}),n(a,{class:"bars",type:"search",size:"24",onClick:e[1]||(e[1]=t=>F(R)("/pages/search/search"))})])),_:1}),n(y,{class:"main"},{default:r((()=>[n(y,{class:"login"},{default:r((()=>[n(x,{src:s.value?s.value.avatarUrl:"/icon/icon-avatar.png",mode:"widthFix",class:"login-img"},null,8,["src"]),$(n(y,{class:"login-name"},{default:r((()=>{var t;return[p(f(null==(t=s.value)?void 0:t.nickname),1)]})),_:1},512),[[j,o.value]]),$(n(y,{class:"login-name",onClick:e[2]||(e[2]=()=>{F(R)("/pages/login/login")})},{default:r((()=>[p(" 立即登录 ")])),_:1},512),[[j,!o.value]])])),_:1}),n(y,{class:"connect"},{default:r((()=>[n(D,{class:"toggle",tabList:k.value,onTabIndexEvent:U},null,8,["tabList"]),0===g.value?(i(),l(y,{key:0,class:"view"},{default:r((()=>[(i(!0),c(d,null,u(_.value,((t,e)=>(i(),l(C,{border:!1,key:e},{default:r((()=>[n(T,{title:t.name,to:"/pages/songsList/songsList?id="+t.id+"&title=个人收藏",avatar:t.coverImgUrl,note:t.trackCount+"首"},null,8,["title","to","avatar","note"])])),_:2},1024)))),128))])),_:1})):m("",!0),1===g.value?(i(),l(y,{key:1,class:"view"},{default:r((()=>[p(" 播客 ")])),_:1})):m("",!0),2===g.value?(i(),l(y,{key:2,class:"view"},{default:r((()=>[p(" 动态 ")])),_:1})):m("",!0)])),_:1})])),_:1}),n(P,{ref_key:"sidebar",ref:h},null,512)])),_:1}),n(S)],64)}}},[["__scopeId","data-v-603099be"]]);export{M as default};
