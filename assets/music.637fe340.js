import{aI as e,aJ as a,m as l,K as u,aK as s,aL as v,aM as n,aN as o}from"./index-774346cf.js";const t=e("musicStore",(()=>{const e=a(),t=l(!1);l([]);const i=l([]),c=l([]),r=l(null),d=l(""),m=l(2),p=l(null),h=l({points:"00",seconds:"00"}),f=l({points:"00",seconds:"00"}),g=l([]),M=l(""),I=l(""),y=l(null),N=l(null),S=()=>{s(i.value[r.value].id,"standard").then((a=>{d.value=a.data[0].url,e.src=d.value,e.autoplay=!0,e.loop=!0,t.value=!0}))},b=()=>{clearInterval(p.value),f.value.seconds="00",f.value.points="00",h.value.seconds="00",h.value.points="00"};u(c,((e,a)=>{c.value=i.value[r.value],S(),b()})),u(r,((e,a)=>{c.value=i.value[r.value],b(),S()}));const x=e=>{clearInterval(p.value),t.value=!1,r.value+=e,r.value<0?r.value=i.value.length-1:r.value===i.value.length&&(r.value=0)};e.onCanplay((()=>{L()}));const L=()=>{h.value.points=Math.floor(e.duration/60)>10?Math.floor(e.duration/60)+"":"0"+Math.floor(e.duration/60),h.value.seconds=Math.floor(e.duration-60*Number(h.value.points))>10?Math.floor(e.duration-60*Number(h.value.points))+"":"0"+Math.floor(e.duration-60*Number(h.value.points)),p.value=setInterval((()=>{let a=Number(f.value.seconds)+1;if(f.value.seconds=a>=10?a+"":"0"+a,"60"===f.value.seconds){f.value.seconds="00";let e=Number(f.value.points)+1;f.value.points=e>=10?e+"":"0"+e}if(f.value.seconds===h.value.seconds&&f.value.points===h.value.points)if(b(),1===m.value)e.loop=!1,x(1);else if(2===m.value)e.loop=!0;else if(3===m.value){e.loop=!1;let a=i.value.length-1;x(Math.floor(Math.random()*a)+1)}}),1e3)};return{audio:e,isplay:t,play:()=>{e.paused?(e.play(),t.value=!0,L()):(e.pause(),t.value=!1,clearInterval(p.value))},musicAllList:(e,a,l,u)=>{i.value=e,c.value=a,r.value=l,M.value=u,clearInterval(p.value);if(g.value.find((e=>e.name===M.value))){const e=g.value.findIndex((e=>e.name===M.value));g.value[e].music.find((e=>e.name===c.value.name))||g.value[e].music.push(c.value)}else g.value.push({name:M.value,music:[c.value]})},musicList:i,musicIndex:r,musicLove:c,musicSubtract:x,musicSearch:(e,a)=>{const l=i.value.findIndex((a=>a.id===e.id));-1===l?(i.value.unshift(e),c.value=i.value[0],r.value=0):(c.value=i.value[l],r.value=l),b(),S()},musicBack:d,musicMode:m,musicToggle:()=>{m.value+=1,m.value>3&&(m.value=1)},musicBehind:e=>{0===i.value.length?(i.value.push(e),c.value=e,r.value=0):i.value.splice(r.value,0,e)},musicTime:h,musicNowTime:f,musicHistory:g,musicType:M,timestampToYMD:e=>{const a=new Date(e);return`${a.getFullYear()}.${String(a.getMonth()+1).padStart(2,"0")}.${String(a.getDate()).padStart(2,"0")}`},musicHistoryOne:(e,a)=>{const l=g.value[e].music.findIndex((e=>e.id===a.id));g.value[e].music.splice(l,1)},musicHistoryAll:()=>{g.value=[]},musicMv:a=>{e.pause(),t.value=!1,clearInterval(p.value),y.value=a,v(a.id).then((e=>{console.log("mv播放地址",e),I.value=e.data.url})),n(a.id).then((e=>{console.log("mv数据",e)})),o(a.id).then((e=>{console.log("mv品论",e)})),e.pause(),t.value=!1,clearInterval(p.value)},musicLookMv:I,musicDetails:y,musicListId:N}}));export{t as u};
