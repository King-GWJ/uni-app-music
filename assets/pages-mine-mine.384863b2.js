import{_ as t,N as e,O as a,P as s,Q as l,o as i,c as n,w as r,b as c,k as d,x as o,F as u,y as h,n as f,d as _,e as p,t as g,f as m,R as v,g as b,z as k,j as y,m as x,T as S,U as T,l as C,H as L,J as w,V as I,K as F,v as $,r as B,a as U}from"./index-43ced767.js";import{_ as A}from"./uni-icons.ac3eeace.js";import{W}from"./uni-cloud.es.500efbb6.js";import{S as P,n as j}from"./Sidebar.0d7f2472.js";const D=t({name:"UniListChat",emits:["click"],props:{title:{type:String,default:""},note:{type:String,default:""},clickable:{type:Boolean,default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},badgeText:{type:[String,Number],default:""},badgePositon:{type:String,default:"right"},time:{type:String,default:""},avatarCircle:{type:Boolean,default:!1},avatar:{type:String,default:""},avatarList:{type:Array,default:()=>[]}},computed:{isDraft(){return"[uni-im-draft]"==this.note.slice(0,14)},isSingle(){if("dot"===this.badgeText)return"uni-badge--dot";return this.badgeText.toString().length>1?"uni-badge--complex":"uni-badge--single"},computedAvatar(){return this.avatarList.length>4?(this.imageWidth=13.95,"avatarItem--3"):this.avatarList.length>1?(this.imageWidth=21.15,"avatarItem--2"):(this.imageWidth=45,"avatarItem--1")}},watch:{avatar:{handler(t){"cloud://"==t.substr(0,8)?W.getTempFileURL({fileList:[t]}).then((t=>{let e=t.fileList||t.result.fileList;this.avatarUrl=e[0].tempFileURL})):this.avatarUrl=t},immediate:!0}},data:()=>({isFirstChild:!1,border:!0,imageWidth:50,avatarUrl:""}),mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0),this.border=this.list.border)},methods:{getForm(t="uniList"){let e=this.$parent,a=e.$options.name;for(;a!==t;){if(e=e.$parent,!e)return!1;a=e.$options.name}return e},onClick(){""===this.to?(this.clickable||this.link)&&this.$emit("click",{data:{}}):this.openPage()},openPage(){-1!==["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(t){let i={url:this.to,success:t=>{this.$emit("click",{data:t})},fail:t=>{this.$emit("click",{data:t})}};switch(t){case"navigateTo":default:e(i);break;case"redirectTo":l(i);break;case"reLaunch":s(i);break;case"switchTab":a(i)}}}},[["render",function(t,e,a,s,l,x){const S=b,T=k,C=y;return i(),n(S,{"hover-class":a.clickable||a.link?"uni-list-chat--hover":"",class:"uni-list-chat",onClick:v(x.onClick,["stop"])},{default:r((()=>[c(S,{class:d({"uni-list--border":l.border,"uni-list-chat--first":l.isFirstChild})},null,8,["class"]),c(S,{class:"uni-list-chat__container"},{default:r((()=>[c(S,{class:"uni-list-chat__header-warp"},{default:r((()=>[a.avatarCircle||0===a.avatarList.length?(i(),n(S,{key:0,class:d(["uni-list-chat__header",{"header--circle":a.avatarCircle}])},{default:r((()=>[c(T,{class:d(["uni-list-chat__header-image",{"header--circle":a.avatarCircle}]),src:l.avatarUrl,mode:"aspectFill"},null,8,["class","src"])])),_:1},8,["class"])):(i(),n(S,{key:1,class:"uni-list-chat__header"},{default:r((()=>[(i(!0),o(u,null,h(a.avatarList,((t,e)=>(i(),n(S,{key:e,class:d(["uni-list-chat__header-box",x.computedAvatar]),style:f({width:l.imageWidth+"px",height:l.imageWidth+"px"})},{default:r((()=>[c(T,{class:"uni-list-chat__header-image",style:f({width:l.imageWidth+"px",height:l.imageWidth+"px"}),src:t.url,mode:"aspectFill"},null,8,["style","src"])])),_:2},1032,["class","style"])))),128))])),_:1}))])),_:1}),c(S,{class:"slot-header"},{default:r((()=>[_(t.$slots,"header",{},void 0,!0)])),_:3}),a.badgeText&&"left"===a.badgePositon?(i(),n(S,{key:0,class:d(["uni-list-chat__badge uni-list-chat__badge-pos",[x.isSingle]])},{default:r((()=>[c(C,{class:"uni-list-chat__badge-text"},{default:r((()=>[p(g("dot"===a.badgeText?"":a.badgeText),1)])),_:1})])),_:1},8,["class"])):m("",!0),c(S,{class:"uni-list-chat__content"},{default:r((()=>[c(S,{class:"uni-list-chat__content-main"},{default:r((()=>[c(C,{class:"uni-list-chat__content-title uni-ellipsis"},{default:r((()=>[p(g(a.title),1)])),_:1}),c(S,{style:{"flex-direction":"row"}},{default:r((()=>[x.isDraft?(i(),n(C,{key:0,class:"draft"},{default:r((()=>[p("[草稿]")])),_:1})):m("",!0),c(C,{class:"uni-list-chat__content-note uni-ellipsis"},{default:r((()=>[p(g(x.isDraft?a.note.slice(14):a.note),1)])),_:1})])),_:1})])),_:1}),c(S,{class:"uni-list-chat__content-extra"},{default:r((()=>[_(t.$slots,"default",{},(()=>[c(C,{class:"uni-list-chat__content-extra-text"},{default:r((()=>[p(g(a.time),1)])),_:1}),a.badgeText&&"right"===a.badgePositon?(i(),n(S,{key:0,class:d(["uni-list-chat__badge",[x.isSingle,"right"===a.badgePositon?"uni-list-chat--right":""]])},{default:r((()=>[c(C,{class:"uni-list-chat__badge-text"},{default:r((()=>[p(g("dot"===a.badgeText?"":a.badgeText),1)])),_:1})])),_:1},8,["class"])):m("",!0)]),!0)])),_:3})])),_:3})])),_:3})])),_:3},8,["hover-class","onClick"])}],["__scopeId","data-v-5d9ad8b2"]]);const E=t({name:"uniList","mp-weixin":{options:{multipleSlots:!1}},props:{stackFromEnd:{type:Boolean,default:!1},enableBackToTop:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},border:{type:Boolean,default:!0},renderReverse:{type:Boolean,default:!1}},created(){this.firstChildAppend=!1},methods:{loadMore(t){this.$emit("scrolltolower")},scroll(t){this.$emit("scroll",t)}}},[["render",function(t,e,a,s,l,c){const d=b;return i(),n(d,{class:"uni-list uni-border-top-bottom"},{default:r((()=>[a.border?(i(),n(d,{key:0,class:"uni-list--border-top"})):m("",!0),_(t.$slots,"default",{},void 0,!0),a.border?(i(),n(d,{key:1,class:"uni-list--border-bottom"})):m("",!0)])),_:3})}],["__scopeId","data-v-1f7cd97b"]]),R=t({__name:"TabToggle",props:["tabList"],emits:["tabIndexEvent"],setup(t,{emit:e}){const a=e,s=x(t.tabList);return(t,e)=>{const l=y,d=b;return i(),n(d,{class:"tabView"},{default:r((()=>[(i(!0),o(u,null,h(s.value,((t,e)=>(i(),n(d,{class:"tabBar",key:e,onClick:t=>(t=>{let e=[];s.value.map(((a,s)=>{a.isSelect=t===s,e.push(a)})),s.value=e,a("tabIndexEvent",t)})(e)},{default:r((()=>[c(l,{class:"title",style:f({color:t.isSelect?"#000000":"#9298a1"})},{default:r((()=>[p(g(t.name),1)])),_:2},1032,["style"]),S(c(d,{class:"iden",style:{background:"#ea4550"}},null,512),[[T,t.isSelect]])])),_:2},1032,["onClick"])))),128))])),_:1})}}},[["__scopeId","data-v-dd9ba249"]]),z=t({__name:"mine",setup(t){const e=C("curCookie"),a=L(),s=x(a.profile),l=x(!1),d=x(null),f=x(0),_=x([]);w((()=>{var t;l.value=!!e,s.value?I(null==(t=s.value)?void 0:t.userId).then((t=>{_.value=t.playlist})):s.value=a.setProfileData()})),F(s,(()=>{var t;I(null==(t=s.value)?void 0:t.userId).then((t=>{_.value=t.playlist}))}));const v=x([{isSelect:!0,name:"音乐"},{isSelect:!1,name:"播客"},{isSelect:!1,name:"动态"}]),y=t=>{f.value=t};return(t,e)=>{const a=B(U("uni-icons"),A),x=b,C=k,L=B(U("uni-list-chat"),D),w=B(U("uni-list"),E);return i(),n(x,{class:"content"},{default:r((()=>[c(x,{class:"header"},{default:r((()=>[c(a,{class:"bars",type:"bars",size:"24",onClick:e[0]||(e[0]=()=>{d.value.showDrawer()})}),c(a,{class:"bars",type:"search",size:"24",onClick:e[1]||(e[1]=t=>$(j)("/pages/search/search"))})])),_:1}),c(x,{class:"main"},{default:r((()=>[c(x,{class:"login"},{default:r((()=>{var t;return[S(c(C,{src:null==(t=s.value)?void 0:t.avatarUrl,mode:"widthFix",class:"login-img"},null,8,["src"]),[[T,l.value]]),S(c(x,{class:"login-name"},{default:r((()=>{var t;return[p(g(null==(t=s.value)?void 0:t.nickname),1)]})),_:1},512),[[T,l.value]]),S(c(x,{class:"login-name",onClick:e[2]||(e[2]=()=>{$(j)("/pages/login/login")})},{default:r((()=>[p(" 立即登录 ")])),_:1},512),[[T,!l.value]])]})),_:1}),c(x,{class:"connect"},{default:r((()=>[c(R,{tabList:v.value,onTabIndexEvent:y},null,8,["tabList"]),0===f.value?(i(),n(x,{key:0,class:"view"},{default:r((()=>[(i(!0),o(u,null,h(_.value,((t,e)=>(i(),n(w,{border:!1,key:e},{default:r((()=>[c(L,{title:t.name,to:"/pages/acquiesce/acquiesce?id=",avatar:t.coverImgUrl,note:t.trackCount+"首"},null,8,["title","avatar","note"])])),_:2},1024)))),128))])),_:1})):m("",!0),1===f.value?(i(),n(x,{key:1,class:"view"},{default:r((()=>[p(" 播客 ")])),_:1})):m("",!0),2===f.value?(i(),n(x,{key:2,class:"view"},{default:r((()=>[p(" 动态 ")])),_:1})):m("",!0)])),_:1})])),_:1}),c(P,{ref_key:"sidebar",ref:d},null,512)])),_:1})}}},[["__scopeId","data-v-23b4c778"]]);export{z as default};
