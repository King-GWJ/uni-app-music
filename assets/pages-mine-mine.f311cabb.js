import{N as t,O as e,P as a,Q as s,o as l,c as i,w as n,b as r,k as c,x as o,F as d,y as u,n as h,d as f,e as p,t as _,f as g,R as m,g as v,z as b,j as k,m as y,T as x,U as S,l as T,H as C,J as L,K as w,v as F,V as I,r as $,a as B}from"./index-bf102121.js";import{_ as U}from"./uni-icons.c89e33cf.js";import{W as A}from"./uni-cloud.es.d6b8536f.js";import{_ as W}from"./plugin-vueexport-helper.1b428a4d.js";import{S as P,n as j}from"./Sidebar.8035e617.js";const D=W({name:"UniListChat",emits:["click"],props:{title:{type:String,default:""},note:{type:String,default:""},clickable:{type:Boolean,default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},badgeText:{type:[String,Number],default:""},badgePositon:{type:String,default:"right"},time:{type:String,default:""},avatarCircle:{type:Boolean,default:!1},avatar:{type:String,default:""},avatarList:{type:Array,default:()=>[]}},computed:{isDraft(){return"[uni-im-draft]"==this.note.slice(0,14)},isSingle(){if("dot"===this.badgeText)return"uni-badge--dot";return this.badgeText.toString().length>1?"uni-badge--complex":"uni-badge--single"},computedAvatar(){return this.avatarList.length>4?(this.imageWidth=13.95,"avatarItem--3"):this.avatarList.length>1?(this.imageWidth=21.15,"avatarItem--2"):(this.imageWidth=45,"avatarItem--1")}},watch:{avatar:{handler(t){"cloud://"==t.substr(0,8)?A.getTempFileURL({fileList:[t]}).then((t=>{let e=t.fileList||t.result.fileList;this.avatarUrl=e[0].tempFileURL})):this.avatarUrl=t},immediate:!0}},data:()=>({isFirstChild:!1,border:!0,imageWidth:50,avatarUrl:""}),mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0),this.border=this.list.border)},methods:{getForm(t="uniList"){let e=this.$parent,a=e.$options.name;for(;a!==t;){if(e=e.$parent,!e)return!1;a=e.$options.name}return e},onClick(){""===this.to?(this.clickable||this.link)&&this.$emit("click",{data:{}}):this.openPage()},openPage(){-1!==["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(l){let i={url:this.to,success:t=>{this.$emit("click",{data:t})},fail:t=>{this.$emit("click",{data:t})}};switch(l){case"navigateTo":default:t(i);break;case"redirectTo":s(i);break;case"reLaunch":a(i);break;case"switchTab":e(i)}}}},[["render",function(t,e,a,s,y,x){const S=v,T=b,C=k;return l(),i(S,{"hover-class":a.clickable||a.link?"uni-list-chat--hover":"",class:"uni-list-chat",onClick:m(x.onClick,["stop"])},{default:n((()=>[r(S,{class:c({"uni-list--border":y.border,"uni-list-chat--first":y.isFirstChild})},null,8,["class"]),r(S,{class:"uni-list-chat__container"},{default:n((()=>[r(S,{class:"uni-list-chat__header-warp"},{default:n((()=>[a.avatarCircle||0===a.avatarList.length?(l(),i(S,{key:0,class:c(["uni-list-chat__header",{"header--circle":a.avatarCircle}])},{default:n((()=>[r(T,{class:c(["uni-list-chat__header-image",{"header--circle":a.avatarCircle}]),src:y.avatarUrl,mode:"aspectFill"},null,8,["class","src"])])),_:1},8,["class"])):(l(),i(S,{key:1,class:"uni-list-chat__header"},{default:n((()=>[(l(!0),o(d,null,u(a.avatarList,((t,e)=>(l(),i(S,{key:e,class:c(["uni-list-chat__header-box",x.computedAvatar]),style:h({width:y.imageWidth+"px",height:y.imageWidth+"px"})},{default:n((()=>[r(T,{class:"uni-list-chat__header-image",style:h({width:y.imageWidth+"px",height:y.imageWidth+"px"}),src:t.url,mode:"aspectFill"},null,8,["style","src"])])),_:2},1032,["class","style"])))),128))])),_:1}))])),_:1}),r(S,{class:"slot-header"},{default:n((()=>[f(t.$slots,"header",{},void 0,!0)])),_:3}),a.badgeText&&"left"===a.badgePositon?(l(),i(S,{key:0,class:c(["uni-list-chat__badge uni-list-chat__badge-pos",[x.isSingle]])},{default:n((()=>[r(C,{class:"uni-list-chat__badge-text"},{default:n((()=>[p(_("dot"===a.badgeText?"":a.badgeText),1)])),_:1})])),_:1},8,["class"])):g("",!0),r(S,{class:"uni-list-chat__content"},{default:n((()=>[r(S,{class:"uni-list-chat__content-main"},{default:n((()=>[r(C,{class:"uni-list-chat__content-title uni-ellipsis"},{default:n((()=>[p(_(a.title),1)])),_:1}),r(S,{style:{"flex-direction":"row"}},{default:n((()=>[x.isDraft?(l(),i(C,{key:0,class:"draft"},{default:n((()=>[p("[草稿]")])),_:1})):g("",!0),r(C,{class:"uni-list-chat__content-note uni-ellipsis"},{default:n((()=>[p(_(x.isDraft?a.note.slice(14):a.note),1)])),_:1})])),_:1})])),_:1}),r(S,{class:"uni-list-chat__content-extra"},{default:n((()=>[f(t.$slots,"default",{},(()=>[r(C,{class:"uni-list-chat__content-extra-text"},{default:n((()=>[p(_(a.time),1)])),_:1}),a.badgeText&&"right"===a.badgePositon?(l(),i(S,{key:0,class:c(["uni-list-chat__badge",[x.isSingle,"right"===a.badgePositon?"uni-list-chat--right":""]])},{default:n((()=>[r(C,{class:"uni-list-chat__badge-text"},{default:n((()=>[p(_("dot"===a.badgeText?"":a.badgeText),1)])),_:1})])),_:1},8,["class"])):g("",!0)]),!0)])),_:3})])),_:3})])),_:3})])),_:3},8,["hover-class","onClick"])}],["__scopeId","data-v-5d9ad8b2"]]);const E=W({name:"uniList","mp-weixin":{options:{multipleSlots:!1}},props:{stackFromEnd:{type:Boolean,default:!1},enableBackToTop:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},border:{type:Boolean,default:!0},renderReverse:{type:Boolean,default:!1}},created(){this.firstChildAppend=!1},methods:{loadMore(t){this.$emit("scrolltolower")},scroll(t){this.$emit("scroll",t)}}},[["render",function(t,e,a,s,r,c){const o=v;return l(),i(o,{class:"uni-list uni-border-top-bottom"},{default:n((()=>[a.border?(l(),i(o,{key:0,class:"uni-list--border-top"})):g("",!0),f(t.$slots,"default",{},void 0,!0),a.border?(l(),i(o,{key:1,class:"uni-list--border-bottom"})):g("",!0)])),_:3})}],["__scopeId","data-v-1f7cd97b"]]),R=W({__name:"TabToggle",props:["tabList"],emits:["tabIndexEvent"],setup(t,{emit:e}){const a=e,s=y(t.tabList);return(t,e)=>{const c=k,f=v;return l(),i(f,{class:"tabView"},{default:n((()=>[(l(!0),o(d,null,u(s.value,((t,e)=>(l(),i(f,{class:"tabBar",key:e,onClick:t=>(t=>{let e=[];s.value.map(((a,s)=>{a.isSelect=t===s,e.push(a)})),s.value=e,a("tabIndexEvent",t)})(e)},{default:n((()=>[r(c,{class:"title",style:h({color:t.isSelect?"#000000":"#9298a1"})},{default:n((()=>[p(_(t.name),1)])),_:2},1032,["style"]),x(r(f,{class:"iden",style:{background:"#ea4550"}},null,512),[[S,t.isSelect]])])),_:2},1032,["onClick"])))),128))])),_:1})}}},[["__scopeId","data-v-dd9ba249"]]),z=W({__name:"mine",setup(t){const e=T("curCookie"),a=C(),s=y(a.profile),c=y(!1),h=y(null),f=y(0),m=y([]);L((()=>{c.value=!!e,s.value||(s.value=a.setProfileData())})),w(s,(()=>{var t;I(null==(t=s.value)?void 0:t.userId).then((t=>{m.value=t.playlist}))}));const k=y([{isSelect:!0,name:"音乐"},{isSelect:!1,name:"播客"},{isSelect:!1,name:"动态"}]),A=t=>{f.value=t};return(t,e)=>{const a=$(B("uni-icons"),U),y=v,T=b,C=$(B("uni-list-chat"),D),L=$(B("uni-list"),E);return l(),i(y,{class:"content"},{default:n((()=>[r(y,{class:"header"},{default:n((()=>[r(a,{class:"bars",type:"bars",size:"24",onClick:e[0]||(e[0]=()=>{h.value.showDrawer()})}),r(a,{class:"bars",type:"search",size:"24",onClick:e[1]||(e[1]=t=>F(j)("/pages/search/search"))})])),_:1}),r(y,{class:"main"},{default:n((()=>[r(y,{class:"login"},{default:n((()=>{var t;return[x(r(T,{src:null==(t=s.value)?void 0:t.avatarUrl,mode:"widthFix",class:"login-img"},null,8,["src"]),[[S,c.value]]),x(r(y,{class:"login-name"},{default:n((()=>{var t;return[p(_(null==(t=s.value)?void 0:t.nickname),1)]})),_:1},512),[[S,c.value]]),x(r(y,{class:"login-name",onClick:e[2]||(e[2]=()=>{F(j)("/pages/login/login")})},{default:n((()=>[p(" 立即登录 ")])),_:1},512),[[S,!c.value]])]})),_:1}),r(y,{class:"connect"},{default:n((()=>[r(R,{tabList:k.value,onTabIndexEvent:A},null,8,["tabList"]),0===f.value?(l(),i(y,{key:0,class:"view"},{default:n((()=>[(l(!0),o(d,null,u(m.value,((t,e)=>(l(),i(L,{border:!1,key:e},{default:n((()=>[r(C,{title:t.name,to:"/pages/acquiesce/acquiesce?id=",avatar:t.coverImgUrl,note:t.trackCount+"首"},null,8,["title","avatar","note"])])),_:2},1024)))),128))])),_:1})):g("",!0),1===f.value?(l(),i(y,{key:1,class:"view"},{default:n((()=>[p(" 播客 ")])),_:1})):g("",!0),2===f.value?(l(),i(y,{key:2,class:"view"},{default:n((()=>[p(" 动态 ")])),_:1})):g("",!0)])),_:1})])),_:1}),r(P,{ref_key:"sidebar",ref:h},null,512)])),_:1})}}},[["__scopeId","data-v-23095d43"]]);export{z as default};
